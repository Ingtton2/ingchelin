{"ast":null,"code":"import React,{useState,useEffect}from'react';import{useFavorites}from'../context/FavoriteContext';import{useVisit}from'../context/VisitContext';import{useSearchParams}from'react-router-dom';import RestaurantDetailModal from'../components/RestaurantDetailModal';import{supabase}from'../services/supabase';import{restaurantData}from'../data/restaurantData';import'./Map.css';import{jsx as _jsx,jsxs as _jsxs}from\"react/jsx-runtime\";function KakaoMap(){const[restaurants,setRestaurants]=useState([]);const[selectedRestaurant,setSelectedRestaurant]=useState(null);const{addToFavorites,removeFromFavorites,isInFavorites}=useFavorites();const{getRestaurantVisitStatus,setRestaurantVisitStatus}=useVisit();const[mapLoaded,setMapLoaded]=useState(false);const[userLocation,setUserLocation]=useState(null);const[nearbyRestaurants,setNearbyRestaurants]=useState([]);const[userMarker,setUserMarker]=useState(null);const[isLoadingLocation,setIsLoadingLocation]=useState(false);const[searchParams]=useSearchParams();const[mapInstance,setMapInstance]=useState(null);// 새로운 상태들\nconst[searchQuery,setSearchQuery]=useState('');const[selectedCategories,setSelectedCategories]=useState(['한식','중식','일식','양식','분식','태국','술','카페','디저트']);const[filteredRestaurants,setFilteredRestaurants]=useState([]);// 마커 상태 추가\nconst[markers,setMarkers]=useState([]);const[labels,setLabels]=useState([]);// 미니 팝업 상태 추가\nconst[miniPopup,setMiniPopup]=useState(null);const[popupPosition,setPopupPosition]=useState({x:0,y:0});const[isDragging,setIsDragging]=useState(false);const[dragOffset,setDragOffset]=useState({x:0,y:0});// 상세정보 모달 상태 추가\nconst[detailModal,setDetailModal]=useState(null);// 드래그 이벤트 핸들러\nconst handleMouseDown=e=>{setIsDragging(true);setDragOffset({x:e.clientX-popupPosition.x,y:e.clientY-popupPosition.y});};const handleMouseMove=e=>{if(isDragging){setPopupPosition({x:e.clientX-dragOffset.x,y:e.clientY-dragOffset.y});}};const handleMouseUp=()=>{setIsDragging(false);};// 카테고리 옵션\nconst categories=['한식','중식','일식','양식','분식','태국','술','카페','디저트'];// Supabase에서 레스토랑 데이터 가져오기\nconst fetchRestaurants=async()=>{try{// Supabase에서 레스토랑 데이터 가져오기\nconst{data,error}=await supabase.from('restaurants').select('*');if(error){console.warn('Supabase 연결 실패, 기본 데이터 사용:',error);// 기본 데이터 반환\nconst defaultData=restaurantData.map(restaurant=>({id:restaurant.id,name:restaurant.name,category:restaurant.category,rating:restaurant.rating,address:restaurant.address,description:restaurant.description,price:restaurant.price||\"1만원~3만원\",position:{lat:restaurant.position.lat,lng:restaurant.position.lng},businessHours:restaurant.hours||\"11:00 - 22:00\",phone:restaurant.phone||\"02-0000-0000\",parking:restaurant.parking||\"주차 가능\"}));setRestaurants(defaultData);setFilteredRestaurants(defaultData);return;}// Supabase 데이터가 있으면 사용, 없으면 기본 데이터 사용\nif(data&&data.length>0){console.log('Supabase 데이터 사용:',data.length,'개 레스토랑');const formattedData=data.map(restaurant=>({id:restaurant.id,name:restaurant.name,category:restaurant.cuisine||restaurant.category,rating:restaurant.rating||4.0,address:restaurant.address,description:restaurant.description||`${restaurant.cuisine||restaurant.category} 전문점입니다.`,price:restaurant.price||\"1만원~3만원\",position:{lat:restaurant.latitude||37.5665,lng:restaurant.longitude||126.9780},businessHours:restaurant.businessHours||\"11:00 - 22:00\",phone:restaurant.phone||\"02-0000-0000\",parking:restaurant.parking?\"주차 가능\":\"주차 불가\"}));setRestaurants(formattedData);setFilteredRestaurants(formattedData);}else{console.log('Supabase 데이터 없음, 기본 데이터 사용');const defaultData=restaurantData.map(restaurant=>({id:restaurant.id,name:restaurant.name,category:restaurant.category,rating:restaurant.rating,address:restaurant.address,description:restaurant.description,price:restaurant.price||\"1만원~3만원\",position:{lat:restaurant.position.lat,lng:restaurant.position.lng},businessHours:restaurant.hours||\"11:00 - 22:00\",phone:restaurant.phone||\"02-0000-0000\",parking:restaurant.parking||\"주차 가능\"}));setRestaurants(defaultData);setFilteredRestaurants(defaultData);}}catch(error){console.warn('API 호출 실패, 기본 데이터 사용:',error);const defaultData=restaurantData.map(restaurant=>({id:restaurant.id,name:restaurant.name,category:restaurant.category,rating:restaurant.rating,address:restaurant.address,description:restaurant.description,price:restaurant.price||\"1만원~3만원\",position:{lat:restaurant.position.lat,lng:restaurant.position.lng},businessHours:restaurant.hours||\"11:00 - 22:00\",phone:restaurant.phone||\"02-0000-0000\",parking:restaurant.parking||\"주차 가능\"}));setRestaurants(defaultData);setFilteredRestaurants(defaultData);}};// 컴포넌트 마운트 시 데이터 가져오기\nuseEffect(()=>{fetchRestaurants();},[]);// 검색 및 필터링 함수\nuseEffect(()=>{let filtered=restaurants;// 검색어 필터링\nif(searchQuery.trim()){filtered=filtered.filter(restaurant=>restaurant.name.toLowerCase().includes(searchQuery.toLowerCase())||restaurant.address.toLowerCase().includes(searchQuery.toLowerCase())||restaurant.category.toLowerCase().includes(searchQuery.toLowerCase()));}// 카테고리 필터링\nfiltered=filtered.filter(restaurant=>selectedCategories.includes(restaurant.category));setFilteredRestaurants(filtered);},[restaurants,searchQuery,selectedCategories]);// 마커 업데이트 함수\nconst updateMapMarkers=restaurantsToShow=>{if(!mapInstance)return;// 기존 마커와 라벨 제거\nmarkers.forEach(marker=>marker.setMap(null));labels.forEach(label=>label.setMap(null));const newMarkers=[];const newLabels=[];// 새로운 마커와 라벨 추가\nrestaurantsToShow.forEach(restaurant=>{// 마커 색상 결정\nlet markerColor='#FF6B6B';// 기본 색상\nlet markerIcon=getCategoryIcon(restaurant.category);// 상태별 색상 적용\nif(isInFavorites(restaurant.id)){markerColor='#FF3B30';// 찜한 맛집 - 빨간색\n}else{const visitStatus=getRestaurantVisitStatus(restaurant.id);if(visitStatus==='liked'){markerColor='#007AFF';// 방문한 곳 (좋았던 곳) - 파란색\n}else if(visitStatus==='disliked'){markerColor='#8E8E93';// 방문한 곳 (별로인 곳) - 회색\n}}// 카테고리별 아이콘과 색상으로 마커 생성\nconst marker=new window.kakao.maps.Marker({position:new window.kakao.maps.LatLng(restaurant.position.lat,restaurant.position.lng),image:new window.kakao.maps.MarkerImage(createMarkerImage(markerColor,markerIcon),new window.kakao.maps.Size(40,40))});marker.setMap(mapInstance);newMarkers.push(marker);// 마커 위에 식당 이름만 표시하는 커스텀 오버레이\nconst content=`\n        <div class=\"marker-label\">\n          <div class=\"marker-label-content\">\n            ${restaurant.name}\n          </div>\n        </div>\n      `;const label=new window.kakao.maps.CustomOverlay({content:content,position:new window.kakao.maps.LatLng(restaurant.position.lat,restaurant.position.lng),xAnchor:0.5,yAnchor:1.5});label.setMap(mapInstance);newLabels.push(label);// 마커 클릭 이벤트\nwindow.kakao.maps.event.addListener(marker,'click',()=>{setSelectedRestaurant(restaurant);// 미니 팝업 표시 - 지도 컨테이너 내 상대적 위치로 계산\nconst position=new window.kakao.maps.LatLng(restaurant.position.lat,restaurant.position.lng);const projection=mapInstance.getProjection();const point=projection.pointFromCoords(position);setMiniPopup(restaurant);setPopupPosition({x:point.x,y:point.y-80// 마커 위에 표시\n});});});setMarkers(newMarkers);setLabels(newLabels);};// 마커 이미지 생성 함수\nconst createMarkerImage=(color,icon)=>{const canvas=document.createElement('canvas');canvas.width=40;canvas.height=40;const ctx=canvas.getContext('2d');// 원형 배경 그리기\nctx.beginPath();ctx.arc(20,20,18,0,2*Math.PI);ctx.fillStyle=color;ctx.fill();ctx.strokeStyle='white';ctx.lineWidth=2;ctx.stroke();// 아이콘 텍스트 그리기\nctx.fillStyle='white';ctx.font='16px Arial';ctx.textAlign='center';ctx.textBaseline='middle';ctx.fillText(icon,20,20);return canvas.toDataURL();};// 필터링된 레스토랑이 변경될 때 마커 업데이트\nuseEffect(()=>{if(mapLoaded&&mapInstance){updateMapMarkers(filteredRestaurants);// URL 파라미터로 특정 식당이 지정된 경우 해당 식당 정보 표시\nconst restaurantId=searchParams.get('restaurantId');if(restaurantId){const selectedRestaurant=filteredRestaurants.find(restaurant=>restaurant.id.toString()===restaurantId);if(selectedRestaurant){setTimeout(()=>{setSelectedRestaurant(selectedRestaurant);},1000);}}}},[filteredRestaurants,mapLoaded,mapInstance,searchParams]);// 카테고리 토글 함수\nconst toggleCategory=category=>{setSelectedCategories(prev=>prev.includes(category)?prev.filter(c=>c!==category):[...prev,category]);};// 모든 카테고리 토글 함수\nconst toggleAllCategories=()=>{setSelectedCategories(selectedCategories.length===categories.length?[]:categories);};// 검색어 초기화 함수\nconst clearSearch=()=>{setSearchQuery('');};// 카테고리 아이콘 반환 함수\nconst getCategoryIcon=category=>{const icons={'한식':'🍚','양식':'🍝','일식':'🍣','중식':'🥢','카페':'☕','디저트':'🍰','분식':'🍡','술':'🍺','태국':'🍜'};return icons[category]||'🍽️';};// 카카오맵 초기화 함수\nconst initKakaoMap=()=>{console.log('🔍 카카오맵 초기화 시작');console.log('📍 현재 URL:',window.location.href);console.log('🌐 카카오맵 API 키:',process.env.REACT_APP_KAKAO_MAP_API_KEY?'설정됨':'설정되지 않음');// 카카오맵 API 로드 확인\nif(window.kakao&&window.kakao.maps){console.log('✅ 카카오맵 API 로드됨');const container=document.getElementById('map');if(!container){console.error('❌ 지도 컨테이너를 찾을 수 없습니다.');return;}console.log('✅ 지도 컨테이너 찾음');// 사용자 위치 가져오기\nif(navigator.geolocation){console.log('📍 위치 정보 요청 시작');navigator.geolocation.getCurrentPosition(position=>{const{latitude,longitude}=position.coords;console.log('✅ 사용자 위치 획득:',latitude,longitude);try{// 사용자 위치로 지도 초기화\nconst options={center:new window.kakao.maps.LatLng(latitude,longitude),level:6};const map=new window.kakao.maps.Map(container,options);setMapInstance(map);setMapLoaded(true);setUserLocation({lat:latitude,lng:longitude});// 사용자 위치 마커 추가\nconst userMarker=new window.kakao.maps.Marker({position:new window.kakao.maps.LatLng(latitude,longitude),image:new window.kakao.maps.MarkerImage('data:image/svg+xml;base64,PHN2ZyB3aWR0aD0iMjQiIGhlaWdodD0iMjQiIHZpZXdCb3g9IjAgMCAyNCAyNCIgZmlsbD0ibm9uZSIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIj4KPHBhdGggZD0iTTEyIDJDNi40OCAyIDIgNi40OCAyIDEyQzIgMTcuNTIgNi40OCAyMiAxMiAyMkMxNy41MiAyMiAyMiAxNy41MiAyMiAxMkMyMiA2LjQ4IDE3LjUyIDIgMTIgMlpNMTIgMjBDNy41OSAyMCA0IDE2LjQxIDQgMTJDNCA3LjU5IDcuNTkgNCAxMiA0QzE2LjQxIDQgMjAgNy41OSAyMCAxMkMyMCAxNi40MSAxNi40MSAyMCAxMiAyMFoiIGZpbGw9IiM2Njc5ZWEiLz4KPHBhdGggZD0iTTEyIDZDNi40OCA2IDIgMTAuNDggMiAxNkMyIDIxLjUyIDYuNDggMjYgMTIgMjZDNy41OSAyNiA0IDIyLjQxIDQgMThDNCAxMy41OSA3LjU5IDEwIDEyIDEwQzE2LjQxIDEwIDIwIDEzLjU5IDIwIDE4QzIwIDIyLjQxIDE2LjQxIDI2IDEyIDI2WiIgZmlsbD0iIzY2NzllYSIvPgo8L3N2Zz4K',new window.kakao.maps.Size(30,30))});userMarker.setMap(map);setUserMarker(userMarker);console.log('🎉 카카오맵 초기화 완료 (사용자 위치 기반)');}catch(error){console.error('❌ 카카오맵 초기화 오류:',error);// 에러 발생 시 기본 위치로 초기화\ninitKakaoMapWithDefaultLocation();}},error=>{console.log('❌ 위치 정보를 가져올 수 없습니다:',error);// 위치 정보를 가져올 수 없으면 기본 위치로 초기화\ninitKakaoMapWithDefaultLocation();},{enableHighAccuracy:true,timeout:10000,maximumAge:300000// 5분\n});}else{console.log('❌ 위치 정보를 지원하지 않습니다');// 위치 정보를 지원하지 않으면 기본 위치로 초기화\ninitKakaoMapWithDefaultLocation();}}else{console.error('❌ 카카오맵 API가 로드되지 않았습니다.');console.log('🔄 1초 후 재시도...');// 1초 후 다시 시도\nsetTimeout(initKakaoMap,1000);}};// 기본 위치로 지도 초기화하는 함수\nconst initKakaoMapWithDefaultLocation=()=>{console.log('📍 기본 위치로 지도 초기화 시작');try{const container=document.getElementById('map');if(!container){console.error('❌ 지도 컨테이너를 찾을 수 없습니다.');return;}const options={center:new window.kakao.maps.LatLng(37.5665,126.9780),// 서울 시청\nlevel:6};const map=new window.kakao.maps.Map(container,options);setMapInstance(map);setMapLoaded(true);console.log('✅ 카카오맵 초기화 완료 (기본 위치)');}catch(error){console.error('❌ 카카오맵 기본 위치 초기화 오류:',error);// 최종 폴백: 지도 컨테이너에 에러 메시지 표시\nconst container=document.getElementById('map');if(container){container.innerHTML=`\n          <div style=\"display: flex; justify-content: center; align-items: center; height: 100%; background-color: #f5f5f5; color: #666;\">\n            <div style=\"text-align: center;\">\n              <h3>🗺️ 지도를 불러올 수 없습니다</h3>\n              <p>카카오맵 API 연결에 문제가 있습니다.</p>\n              <p>Vercel 환경에서 API 키 설정을 확인해주세요.</p>\n              <button onclick=\"window.location.reload()\" style=\"margin-top: 10px; padding: 8px 16px; background-color: #007bff; color: white; border: none; border-radius: 4px; cursor: pointer;\">\n                새로고침\n              </button>\n            </div>\n          </div>\n        `;}}};// 컴포넌트 마운트 시 지도 초기화\nuseEffect(()=>{// 지도 초기화\ninitKakaoMap();},[]);// 두 지점 간의 거리 계산 (하버사인 공식)\nconst calculateDistance=(lat1,lon1,lat2,lon2)=>{const R=6371;// 지구의 반지름 (km)\nconst dLat=(lat2-lat1)*Math.PI/180;const dLon=(lon2-lon1)*Math.PI/180;const a=Math.sin(dLat/2)*Math.sin(dLat/2)+Math.cos(lat1*Math.PI/180)*Math.cos(lat2*Math.PI/180)*Math.sin(dLon/2)*Math.sin(dLon/2);const c=2*Math.atan2(Math.sqrt(a),Math.sqrt(1-a));const distance=R*c;// km\nreturn distance;};// 사용자 위치 가져오기\nconst getUserLocation=()=>{if(!navigator.geolocation){alert('이 브라우저에서는 위치 정보를 지원하지 않습니다.');return;}setIsLoadingLocation(true);navigator.geolocation.getCurrentPosition(position=>{const{latitude,longitude}=position.coords;const newUserLocation={lat:latitude,lng:longitude};setUserLocation(newUserLocation);// 지도가 로드된 후에만 중심 이동\nif(mapInstance){// 기존 사용자 마커 제거\nif(userMarker){userMarker.setMap(null);}// 사용자 위치로 지도 중심 이동\nmapInstance.setCenter(new window.kakao.maps.LatLng(latitude,longitude));mapInstance.setLevel(5);// 새로운 사용자 위치 마커 추가\nconst newUserMarker=new window.kakao.maps.Marker({position:new window.kakao.maps.LatLng(latitude,longitude),image:new window.kakao.maps.MarkerImage('data:image/svg+xml;base64,PHN2ZyB3aWR0aD0iMjQiIGhlaWdodD0iMjQiIHZpZXdCb3g9IjAgMCAyNCAyNCIgZmlsbD0ibm9uZSIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIj4KPHBhdGggZD0iTTEyIDJDNi40OCAyIDIgNi40OCAyIDEyQzIgMTcuNTIgNi40OCAyMiAxMiAyMkMxNy41MiAyMiAyMiAxNy41MiAyMiAxMkMyMiA2LjQ4IDE3LjUyIDIgMTIgMlpNMTIgMjBDNy41OSAyMCA0IDE2LjQxIDQgMTJDNCA3LjU5IDcuNTkgNCAxMiA0QzE2LjQxIDQgMjAgNy41OSAyMCAxMkMyMCAxNi40MSAxNi40MSAyMCAxMiAyMFoiIGZpbGw9IiM2Njc5ZWEiLz4KPHBhdGggZD0iTTEyIDZDNi40OCA2IDIgMTAuNDggMiAxNkMyIDIxLjUyIDYuNDggMjYgMTIgMjZDNy41OSAyNiA0IDIyLjQxIDQgMThDNCAxMy41OSA3LjU5IDEwIDEyIDEwQzE2LjQxIDEwIDIwIDEzLjU5IDIwIDE4QzIwIDIyLjQxIDE2LjQxIDI2IDEyIDI2WiIgZmlsbD0iIzY2NzllYSIvPgo8L3N2Zz4K',new window.kakao.maps.Size(30,30))});newUserMarker.setMap(mapInstance);setUserMarker(newUserMarker);}// 가까운 식당 찾기 (3km 이내)\nconst restaurantsWithDistance=restaurants.map(restaurant=>{const distance=calculateDistance(latitude,longitude,restaurant.position.lat,restaurant.position.lng);return{...restaurant,distance:distance};});const nearby=restaurantsWithDistance.filter(restaurant=>restaurant.distance<=3).sort((a,b)=>a.distance-b.distance);setNearbyRestaurants(nearby);setIsLoadingLocation(false);},error=>{let errorMessage='위치 정보를 가져올 수 없습니다.';switch(error.code){case error.PERMISSION_DENIED:errorMessage='위치 정보 접근이 거부되었습니다. 브라우저 설정에서 위치 정보 접근을 허용해주세요.';break;case error.POSITION_UNAVAILABLE:errorMessage='위치 정보를 사용할 수 없습니다.';break;case error.TIMEOUT:errorMessage='위치 정보 요청 시간이 초과되었습니다.';break;}alert(errorMessage);setIsLoadingLocation(false);},{enableHighAccuracy:true,timeout:10000,maximumAge:300000// 5분\n});};const getCategoryColor=category=>{const colors={'한식':'#ff6b6b','양식':'#4ecdc4','일식':'#45b7d1','중식':'#96ceb4','동남아식':'#feca57','카페':'#ff9ff3'};return colors[category]||'#95a5a6';};// 현재 시간이 영업시간인지 확인하는 함수\nconst isCurrentlyOpen=businessHours=>{if(!businessHours)return false;const now=new Date();const currentTime=now.getHours()*100+now.getMinutes();// 간단한 시간 파싱 (예: \"11:00 - 22:00\")\nconst timeMatch=businessHours.match(/(\\d{1,2}):(\\d{2})\\s*-\\s*(\\d{1,2}):(\\d{2})/);if(!timeMatch)return true;// 파싱할 수 없으면 영업 중으로 간주\nconst openHour=parseInt(timeMatch[1]);const openMinute=parseInt(timeMatch[2]);const closeHour=parseInt(timeMatch[3]);const closeMinute=parseInt(timeMatch[4]);const openTime=openHour*100+openMinute;const closeTime=closeHour*100+closeMinute;return currentTime>=openTime&&currentTime<=closeTime;};// 평점을 별로 표시하는 함수\nconst renderStars=rating=>{const stars=[];for(let i=1;i<=5;i++){stars.push(/*#__PURE__*/_jsx(\"span\",{className:`star ${i<=rating?'filled':''}`,children:\"\\u2605\"},i));}return stars;};return/*#__PURE__*/_jsxs(\"div\",{className:\"map-container\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"map-header\",children:[/*#__PURE__*/_jsx(\"h2\",{children:\"\\uD83D\\uDDFA\\uFE0F \\uC778\\uC290\\uB7AD \\uB9DB\\uC9D1 \\uC9C0\\uB3C4\"}),/*#__PURE__*/_jsxs(\"div\",{className:\"search-section\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"search-container\",children:[/*#__PURE__*/_jsx(\"input\",{type:\"text\",placeholder:\"\\uC9C0\\uC5ED\\uBA85, \\uB9DB\\uC9D1 \\uC774\\uB984\\uC73C\\uB85C \\uAC80\\uC0C9...\",value:searchQuery,onChange:e=>setSearchQuery(e.target.value),className:\"search-input\"}),searchQuery&&/*#__PURE__*/_jsx(\"button\",{onClick:clearSearch,className:\"clear-search-btn\",children:\"\\u2715\"})]}),/*#__PURE__*/_jsx(\"div\",{className:\"search-results\",children:/*#__PURE__*/_jsxs(\"span\",{className:\"results-count\",children:[filteredRestaurants.length,\"\\uAC1C\\uC758 \\uB9DB\\uC9D1\\uC774 \\uAC80\\uC0C9\\uB418\\uC5C8\\uC2B5\\uB2C8\\uB2E4\"]})})]})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"map-content\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"filter-panel\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"filter-header\",children:[/*#__PURE__*/_jsx(\"h3\",{children:\"\\uD83C\\uDF7D\\uFE0F \\uC74C\\uC2DD \\uC885\\uB958 \\uD544\\uD130\"}),/*#__PURE__*/_jsx(\"button\",{onClick:toggleAllCategories,className:\"toggle-all-btn\",children:selectedCategories.length===categories.length?'전체 해제':'전체 선택'})]}),/*#__PURE__*/_jsx(\"div\",{className:\"category-filters\",children:categories.map(category=>/*#__PURE__*/_jsxs(\"button\",{onClick:()=>toggleCategory(category),className:`category-filter-btn ${selectedCategories.includes(category)?'active':''}`,children:[getCategoryIcon(category),\" \",category]},category))}),selectedRestaurant&&/*#__PURE__*/_jsxs(\"div\",{className:\"selected-restaurant-info\",children:[/*#__PURE__*/_jsx(\"h4\",{children:\"\\uD83D\\uDCCB \\uC120\\uD0DD\\uB41C \\uB9DB\\uC9D1\"}),/*#__PURE__*/_jsxs(\"div\",{className:\"restaurant-card\",children:[/*#__PURE__*/_jsx(\"h5\",{children:selectedRestaurant.name}),/*#__PURE__*/_jsx(\"p\",{className:\"restaurant-category\",children:selectedRestaurant.category}),/*#__PURE__*/_jsxs(\"div\",{className:\"restaurant-rating\",children:[/*#__PURE__*/_jsx(\"span\",{className:\"stars\",children:renderStars(selectedRestaurant.rating)}),/*#__PURE__*/_jsx(\"span\",{className:\"rating-text\",children:selectedRestaurant.rating})]}),/*#__PURE__*/_jsx(\"p\",{className:\"restaurant-description\",children:selectedRestaurant.description}),/*#__PURE__*/_jsxs(\"div\",{className:\"restaurant-details\",children:[/*#__PURE__*/_jsxs(\"p\",{children:[\"\\uD83D\\uDCCD \",selectedRestaurant.address]}),/*#__PURE__*/_jsxs(\"p\",{children:[\"\\uD83D\\uDCB0 \",selectedRestaurant.price]}),/*#__PURE__*/_jsxs(\"p\",{children:[\"\\uD83D\\uDD52 \",selectedRestaurant.businessHours]}),/*#__PURE__*/_jsxs(\"p\",{children:[\"\\uD83D\\uDCDE \",selectedRestaurant.phone]}),/*#__PURE__*/_jsxs(\"p\",{children:[\"\\uD83D\\uDE97 \",selectedRestaurant.parking]})]}),/*#__PURE__*/_jsx(\"div\",{className:\"restaurant-actions\",children:/*#__PURE__*/_jsx(\"button\",{className:`favorite-btn ${isInFavorites(selectedRestaurant.id)?'favorited':''}`,onClick:()=>{if(isInFavorites(selectedRestaurant.id)){removeFromFavorites(selectedRestaurant.id);alert('찜 목록에서 제거되었습니다! 👋');}else{addToFavorites(selectedRestaurant);alert('찜 목록에 추가되었습니다! 🎉');}},children:isInFavorites(selectedRestaurant.id)?'❤️ 찜됨':'🤍 찜하기'})})]})]})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"map-section\",children:[/*#__PURE__*/_jsx(\"div\",{id:\"map\",style:{width:'100%',height:'100%'}}),/*#__PURE__*/_jsx(\"div\",{className:\"map-location-overlay\",children:/*#__PURE__*/_jsx(\"button\",{className:`location-btn ${isLoadingLocation?'loading':''}`,onClick:getUserLocation,disabled:isLoadingLocation,children:isLoadingLocation?'📍 위치 확인 중...':'📍 내 위치로 이동'})}),miniPopup&&/*#__PURE__*/_jsxs(\"div\",{className:\"mini-popup\",style:{left:`${popupPosition.x}px`,top:`${popupPosition.y}px`},onMouseDown:handleMouseDown,onMouseMove:handleMouseMove,onMouseUp:handleMouseUp,onMouseLeave:handleMouseUp,children:[/*#__PURE__*/_jsxs(\"div\",{className:\"mini-popup-header\",children:[/*#__PURE__*/_jsx(\"h4\",{children:miniPopup.name}),/*#__PURE__*/_jsx(\"button\",{className:\"close-popup-btn\",onClick:()=>setMiniPopup(null),children:\"\\u2715\"})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"mini-popup-content\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"mini-popup-rating\",children:[/*#__PURE__*/_jsx(\"div\",{className:\"stars\",children:renderStars(miniPopup.rating)}),/*#__PURE__*/_jsx(\"span\",{className:\"rating-text\",children:miniPopup.rating})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"mini-popup-info\",children:[/*#__PURE__*/_jsxs(\"p\",{className:\"category\",children:[\"\\uD83C\\uDF7D\\uFE0F \",miniPopup.category]}),/*#__PURE__*/_jsx(\"p\",{className:`business-status ${isCurrentlyOpen(miniPopup.businessHours)?'open':'closed'}`,children:isCurrentlyOpen(miniPopup.businessHours)?'🟢 영업 중':'🔴 영업 종료'})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"mini-popup-actions\",children:[/*#__PURE__*/_jsx(\"button\",{className:`favorite-btn ${isInFavorites(miniPopup.id)?'favorited':''}`,onClick:()=>{if(isInFavorites(miniPopup.id)){removeFromFavorites(miniPopup.id);alert('찜 목록에서 제거되었습니다! 👋');}else{addToFavorites(miniPopup);alert('찜 목록에 추가되었습니다! 🎉');}setMiniPopup(null);},children:isInFavorites(miniPopup.id)?'❤️ 찜됨':'🤍 찜하기'}),/*#__PURE__*/_jsx(\"button\",{className:\"detail-btn\",onClick:()=>{setDetailModal(miniPopup);setMiniPopup(null);},children:\"\\uD83D\\uDCCB \\uC0C1\\uC138\\uBCF4\\uAE30\"})]})]})]})]})]}),detailModal&&/*#__PURE__*/_jsx(RestaurantDetailModal,{restaurant:detailModal,onClose:()=>setDetailModal(null)})]});}export default KakaoMap;","map":{"version":3,"names":["React","useState","useEffect","useFavorites","useVisit","useSearchParams","RestaurantDetailModal","supabase","restaurantData","jsx","_jsx","jsxs","_jsxs","KakaoMap","restaurants","setRestaurants","selectedRestaurant","setSelectedRestaurant","addToFavorites","removeFromFavorites","isInFavorites","getRestaurantVisitStatus","setRestaurantVisitStatus","mapLoaded","setMapLoaded","userLocation","setUserLocation","nearbyRestaurants","setNearbyRestaurants","userMarker","setUserMarker","isLoadingLocation","setIsLoadingLocation","searchParams","mapInstance","setMapInstance","searchQuery","setSearchQuery","selectedCategories","setSelectedCategories","filteredRestaurants","setFilteredRestaurants","markers","setMarkers","labels","setLabels","miniPopup","setMiniPopup","popupPosition","setPopupPosition","x","y","isDragging","setIsDragging","dragOffset","setDragOffset","detailModal","setDetailModal","handleMouseDown","e","clientX","clientY","handleMouseMove","handleMouseUp","categories","fetchRestaurants","data","error","from","select","console","warn","defaultData","map","restaurant","id","name","category","rating","address","description","price","position","lat","lng","businessHours","hours","phone","parking","length","log","formattedData","cuisine","latitude","longitude","filtered","trim","filter","toLowerCase","includes","updateMapMarkers","restaurantsToShow","forEach","marker","setMap","label","newMarkers","newLabels","markerColor","markerIcon","getCategoryIcon","visitStatus","window","kakao","maps","Marker","LatLng","image","MarkerImage","createMarkerImage","Size","push","content","CustomOverlay","xAnchor","yAnchor","event","addListener","projection","getProjection","point","pointFromCoords","color","icon","canvas","document","createElement","width","height","ctx","getContext","beginPath","arc","Math","PI","fillStyle","fill","strokeStyle","lineWidth","stroke","font","textAlign","textBaseline","fillText","toDataURL","restaurantId","get","find","toString","setTimeout","toggleCategory","prev","c","toggleAllCategories","clearSearch","icons","initKakaoMap","location","href","process","env","REACT_APP_KAKAO_MAP_API_KEY","container","getElementById","navigator","geolocation","getCurrentPosition","coords","options","center","level","Map","initKakaoMapWithDefaultLocation","enableHighAccuracy","timeout","maximumAge","innerHTML","calculateDistance","lat1","lon1","lat2","lon2","R","dLat","dLon","a","sin","cos","atan2","sqrt","distance","getUserLocation","alert","newUserLocation","setCenter","setLevel","newUserMarker","restaurantsWithDistance","nearby","sort","b","errorMessage","code","PERMISSION_DENIED","POSITION_UNAVAILABLE","TIMEOUT","getCategoryColor","colors","isCurrentlyOpen","now","Date","currentTime","getHours","getMinutes","timeMatch","match","openHour","parseInt","openMinute","closeHour","closeMinute","openTime","closeTime","renderStars","stars","i","className","children","type","placeholder","value","onChange","target","onClick","style","disabled","left","top","onMouseDown","onMouseMove","onMouseUp","onMouseLeave","onClose"],"sources":["/Users/ingtto/Documents/GitHub/ingchelin/src/pages/Map.js"],"sourcesContent":["import React, { useState, useEffect } from 'react';\nimport { useFavorites } from '../context/FavoriteContext';\nimport { useVisit } from '../context/VisitContext';\nimport { useSearchParams } from 'react-router-dom';\nimport RestaurantDetailModal from '../components/RestaurantDetailModal';\nimport { supabase } from '../services/supabase';\nimport { restaurantData } from '../data/restaurantData';\nimport './Map.css';\n\nfunction KakaoMap() {\n  const [restaurants, setRestaurants] = useState([]);\n  const [selectedRestaurant, setSelectedRestaurant] = useState(null);\n  const { addToFavorites, removeFromFavorites, isInFavorites } = useFavorites();\n  const { getRestaurantVisitStatus, setRestaurantVisitStatus } = useVisit();\n  const [mapLoaded, setMapLoaded] = useState(false);\n  const [userLocation, setUserLocation] = useState(null);\n  const [nearbyRestaurants, setNearbyRestaurants] = useState([]);\n  const [userMarker, setUserMarker] = useState(null);\n  const [isLoadingLocation, setIsLoadingLocation] = useState(false);\n  const [searchParams] = useSearchParams();\n  const [mapInstance, setMapInstance] = useState(null);\n  \n  // 새로운 상태들\n  const [searchQuery, setSearchQuery] = useState('');\n  const [selectedCategories, setSelectedCategories] = useState(['한식', '중식', '일식', '양식', '분식', '태국', '술', '카페', '디저트']);\n  const [filteredRestaurants, setFilteredRestaurants] = useState([]);\n  \n  // 마커 상태 추가\n  const [markers, setMarkers] = useState([]);\n  const [labels, setLabels] = useState([]);\n  \n  // 미니 팝업 상태 추가\n  const [miniPopup, setMiniPopup] = useState(null);\n  const [popupPosition, setPopupPosition] = useState({ x: 0, y: 0 });\n  const [isDragging, setIsDragging] = useState(false);\n  const [dragOffset, setDragOffset] = useState({ x: 0, y: 0 });\n  \n  // 상세정보 모달 상태 추가\n  const [detailModal, setDetailModal] = useState(null);\n\n  // 드래그 이벤트 핸들러\n  const handleMouseDown = (e) => {\n    setIsDragging(true);\n    setDragOffset({\n      x: e.clientX - popupPosition.x,\n      y: e.clientY - popupPosition.y\n    });\n  };\n\n  const handleMouseMove = (e) => {\n    if (isDragging) {\n      setPopupPosition({\n        x: e.clientX - dragOffset.x,\n        y: e.clientY - dragOffset.y\n      });\n    }\n  };\n\n  const handleMouseUp = () => {\n    setIsDragging(false);\n  };\n\n  // 카테고리 옵션\n  const categories = ['한식', '중식', '일식', '양식', '분식', '태국', '술', '카페', '디저트'];\n  \n\n\n  // Supabase에서 레스토랑 데이터 가져오기\n  const fetchRestaurants = async () => {\n    try {\n      // Supabase에서 레스토랑 데이터 가져오기\n      const { data, error } = await supabase\n        .from('restaurants')\n        .select('*');\n      \n      if (error) {\n        console.warn('Supabase 연결 실패, 기본 데이터 사용:', error);\n        // 기본 데이터 반환\n        const defaultData = restaurantData.map(restaurant => ({\n          id: restaurant.id,\n          name: restaurant.name,\n          category: restaurant.category,\n          rating: restaurant.rating,\n          address: restaurant.address,\n          description: restaurant.description,\n          price: restaurant.price || \"1만원~3만원\",\n          position: { \n            lat: restaurant.position.lat, \n            lng: restaurant.position.lng \n          },\n          businessHours: restaurant.hours || \"11:00 - 22:00\",\n          phone: restaurant.phone || \"02-0000-0000\",\n          parking: restaurant.parking || \"주차 가능\"\n        }));\n        setRestaurants(defaultData);\n        setFilteredRestaurants(defaultData);\n        return;\n      }\n      \n      // Supabase 데이터가 있으면 사용, 없으면 기본 데이터 사용\n      if (data && data.length > 0) {\n        console.log('Supabase 데이터 사용:', data.length, '개 레스토랑');\n        const formattedData = data.map(restaurant => ({\n          id: restaurant.id,\n          name: restaurant.name,\n          category: restaurant.cuisine || restaurant.category,\n          rating: restaurant.rating || 4.0,\n          address: restaurant.address,\n          description: restaurant.description || `${restaurant.cuisine || restaurant.category} 전문점입니다.`,\n          price: restaurant.price || \"1만원~3만원\",\n          position: { \n            lat: restaurant.latitude || 37.5665, \n            lng: restaurant.longitude || 126.9780 \n          },\n          businessHours: restaurant.businessHours || \"11:00 - 22:00\",\n          phone: restaurant.phone || \"02-0000-0000\",\n          parking: restaurant.parking ? \"주차 가능\" : \"주차 불가\"\n        }));\n        setRestaurants(formattedData);\n        setFilteredRestaurants(formattedData);\n      } else {\n        console.log('Supabase 데이터 없음, 기본 데이터 사용');\n        const defaultData = restaurantData.map(restaurant => ({\n          id: restaurant.id,\n          name: restaurant.name,\n          category: restaurant.category,\n          rating: restaurant.rating,\n          address: restaurant.address,\n          description: restaurant.description,\n          price: restaurant.price || \"1만원~3만원\",\n          position: { \n            lat: restaurant.position.lat, \n            lng: restaurant.position.lng \n          },\n          businessHours: restaurant.hours || \"11:00 - 22:00\",\n          phone: restaurant.phone || \"02-0000-0000\",\n          parking: restaurant.parking || \"주차 가능\"\n        }));\n        setRestaurants(defaultData);\n        setFilteredRestaurants(defaultData);\n      }\n    } catch (error) {\n      console.warn('API 호출 실패, 기본 데이터 사용:', error);\n      const defaultData = restaurantData.map(restaurant => ({\n        id: restaurant.id,\n        name: restaurant.name,\n        category: restaurant.category,\n        rating: restaurant.rating,\n        address: restaurant.address,\n        description: restaurant.description,\n        price: restaurant.price || \"1만원~3만원\",\n        position: { \n          lat: restaurant.position.lat, \n          lng: restaurant.position.lng \n        },\n        businessHours: restaurant.hours || \"11:00 - 22:00\",\n        phone: restaurant.phone || \"02-0000-0000\",\n        parking: restaurant.parking || \"주차 가능\"\n      }));\n      setRestaurants(defaultData);\n      setFilteredRestaurants(defaultData);\n    }\n  };\n\n  // 컴포넌트 마운트 시 데이터 가져오기\n  useEffect(() => {\n    fetchRestaurants();\n  }, []);\n\n  // 검색 및 필터링 함수\n  useEffect(() => {\n    let filtered = restaurants;\n    \n    // 검색어 필터링\n    if (searchQuery.trim()) {\n      filtered = filtered.filter(restaurant => \n        restaurant.name.toLowerCase().includes(searchQuery.toLowerCase()) ||\n        restaurant.address.toLowerCase().includes(searchQuery.toLowerCase()) ||\n        restaurant.category.toLowerCase().includes(searchQuery.toLowerCase())\n      );\n    }\n    \n    // 카테고리 필터링\n    filtered = filtered.filter(restaurant => \n      selectedCategories.includes(restaurant.category)\n    );\n    \n\n    \n    setFilteredRestaurants(filtered);\n  }, [restaurants, searchQuery, selectedCategories]);\n\n  // 마커 업데이트 함수\n  const updateMapMarkers = (restaurantsToShow) => {\n    if (!mapInstance) return;\n\n    // 기존 마커와 라벨 제거\n    markers.forEach(marker => marker.setMap(null));\n    labels.forEach(label => label.setMap(null));\n\n    const newMarkers = [];\n    const newLabels = [];\n\n    // 새로운 마커와 라벨 추가\n    restaurantsToShow.forEach((restaurant) => {\n      // 마커 색상 결정\n      let markerColor = '#FF6B6B'; // 기본 색상\n      let markerIcon = getCategoryIcon(restaurant.category);\n      \n      // 상태별 색상 적용\n      if (isInFavorites(restaurant.id)) {\n        markerColor = '#FF3B30'; // 찜한 맛집 - 빨간색\n      } else {\n        const visitStatus = getRestaurantVisitStatus(restaurant.id);\n        if (visitStatus === 'liked') {\n          markerColor = '#007AFF'; // 방문한 곳 (좋았던 곳) - 파란색\n        } else if (visitStatus === 'disliked') {\n          markerColor = '#8E8E93'; // 방문한 곳 (별로인 곳) - 회색\n        }\n      }\n\n      // 카테고리별 아이콘과 색상으로 마커 생성\n      const marker = new window.kakao.maps.Marker({\n        position: new window.kakao.maps.LatLng(restaurant.position.lat, restaurant.position.lng),\n        image: new window.kakao.maps.MarkerImage(\n          createMarkerImage(markerColor, markerIcon),\n          new window.kakao.maps.Size(40, 40)\n        )\n      });\n      \n      marker.setMap(mapInstance);\n      newMarkers.push(marker);\n      \n      // 마커 위에 식당 이름만 표시하는 커스텀 오버레이\n      const content = `\n        <div class=\"marker-label\">\n          <div class=\"marker-label-content\">\n            ${restaurant.name}\n          </div>\n        </div>\n      `;\n      \n      const label = new window.kakao.maps.CustomOverlay({\n        content: content,\n        position: new window.kakao.maps.LatLng(restaurant.position.lat, restaurant.position.lng),\n        xAnchor: 0.5,\n        yAnchor: 1.5\n      });\n      \n      label.setMap(mapInstance);\n      newLabels.push(label);\n      \n      // 마커 클릭 이벤트\n      window.kakao.maps.event.addListener(marker, 'click', () => {\n        setSelectedRestaurant(restaurant);\n        \n        // 미니 팝업 표시 - 지도 컨테이너 내 상대적 위치로 계산\n        const position = new window.kakao.maps.LatLng(restaurant.position.lat, restaurant.position.lng);\n        const projection = mapInstance.getProjection();\n        const point = projection.pointFromCoords(position);\n        \n        setMiniPopup(restaurant);\n        setPopupPosition({\n          x: point.x,\n          y: point.y - 80 // 마커 위에 표시\n        });\n      });\n    });\n\n    setMarkers(newMarkers);\n    setLabels(newLabels);\n  };\n\n  // 마커 이미지 생성 함수\n  const createMarkerImage = (color, icon) => {\n    const canvas = document.createElement('canvas');\n    canvas.width = 40;\n    canvas.height = 40;\n    const ctx = canvas.getContext('2d');\n    \n    // 원형 배경 그리기\n    ctx.beginPath();\n    ctx.arc(20, 20, 18, 0, 2 * Math.PI);\n    ctx.fillStyle = color;\n    ctx.fill();\n    ctx.strokeStyle = 'white';\n    ctx.lineWidth = 2;\n    ctx.stroke();\n    \n    // 아이콘 텍스트 그리기\n    ctx.fillStyle = 'white';\n    ctx.font = '16px Arial';\n    ctx.textAlign = 'center';\n    ctx.textBaseline = 'middle';\n    ctx.fillText(icon, 20, 20);\n    \n    return canvas.toDataURL();\n  };\n\n  // 필터링된 레스토랑이 변경될 때 마커 업데이트\n  useEffect(() => {\n    if (mapLoaded && mapInstance) {\n      updateMapMarkers(filteredRestaurants);\n      \n      // URL 파라미터로 특정 식당이 지정된 경우 해당 식당 정보 표시\n      const restaurantId = searchParams.get('restaurantId');\n      if (restaurantId) {\n        const selectedRestaurant = filteredRestaurants.find(\n          restaurant => restaurant.id.toString() === restaurantId\n        );\n        if (selectedRestaurant) {\n          setTimeout(() => {\n            setSelectedRestaurant(selectedRestaurant);\n          }, 1000);\n        }\n      }\n    }\n  }, [filteredRestaurants, mapLoaded, mapInstance, searchParams]);\n\n  // 카테고리 토글 함수\n  const toggleCategory = (category) => {\n    setSelectedCategories(prev => \n      prev.includes(category) \n        ? prev.filter(c => c !== category)\n        : [...prev, category]\n    );\n  };\n\n  // 모든 카테고리 토글 함수\n  const toggleAllCategories = () => {\n    setSelectedCategories(selectedCategories.length === categories.length ? [] : categories);\n  };\n\n  // 검색어 초기화 함수\n  const clearSearch = () => {\n    setSearchQuery('');\n  };\n\n  // 카테고리 아이콘 반환 함수\n  const getCategoryIcon = (category) => {\n    const icons = {\n      '한식': '🍚',\n      '양식': '🍝',\n      '일식': '🍣',\n      '중식': '🥢',\n      '카페': '☕',\n      '디저트': '🍰',\n      '분식': '🍡',\n      '술': '🍺',\n      '태국': '🍜'\n    };\n    return icons[category] || '🍽️';\n  };\n\n\n\n  // 카카오맵 초기화 함수\n  const initKakaoMap = () => {\n    console.log('🔍 카카오맵 초기화 시작');\n    console.log('📍 현재 URL:', window.location.href);\n    console.log('🌐 카카오맵 API 키:', process.env.REACT_APP_KAKAO_MAP_API_KEY ? '설정됨' : '설정되지 않음');\n    \n    // 카카오맵 API 로드 확인\n    if (window.kakao && window.kakao.maps) {\n      console.log('✅ 카카오맵 API 로드됨');\n      const container = document.getElementById('map');\n      if (!container) {\n        console.error('❌ 지도 컨테이너를 찾을 수 없습니다.');\n        return;\n      }\n      console.log('✅ 지도 컨테이너 찾음');\n\n      // 사용자 위치 가져오기\n      if (navigator.geolocation) {\n        console.log('📍 위치 정보 요청 시작');\n        navigator.geolocation.getCurrentPosition(\n          (position) => {\n            const { latitude, longitude } = position.coords;\n            console.log('✅ 사용자 위치 획득:', latitude, longitude);\n            \n            try {\n              // 사용자 위치로 지도 초기화\n              const options = {\n                center: new window.kakao.maps.LatLng(latitude, longitude),\n                level: 6\n              };\n              \n              const map = new window.kakao.maps.Map(container, options);\n              setMapInstance(map);\n              setMapLoaded(true);\n              setUserLocation({ lat: latitude, lng: longitude });\n              \n              // 사용자 위치 마커 추가\n              const userMarker = new window.kakao.maps.Marker({\n                position: new window.kakao.maps.LatLng(latitude, longitude),\n                image: new window.kakao.maps.MarkerImage(\n                  'data:image/svg+xml;base64,PHN2ZyB3aWR0aD0iMjQiIGhlaWdodD0iMjQiIHZpZXdCb3g9IjAgMCAyNCAyNCIgZmlsbD0ibm9uZSIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIj4KPHBhdGggZD0iTTEyIDJDNi40OCAyIDIgNi40OCAyIDEyQzIgMTcuNTIgNi40OCAyMiAxMiAyMkMxNy41MiAyMiAyMiAxNy41MiAyMiAxMkMyMiA2LjQ4IDE3LjUyIDIgMTIgMlpNMTIgMjBDNy41OSAyMCA0IDE2LjQxIDQgMTJDNCA3LjU5IDcuNTkgNCAxMiA0QzE2LjQxIDQgMjAgNy41OSAyMCAxMkMyMCAxNi40MSAxNi40MSAyMCAxMiAyMFoiIGZpbGw9IiM2Njc5ZWEiLz4KPHBhdGggZD0iTTEyIDZDNi40OCA2IDIgMTAuNDggMiAxNkMyIDIxLjUyIDYuNDggMjYgMTIgMjZDNy41OSAyNiA0IDIyLjQxIDQgMThDNCAxMy41OSA3LjU5IDEwIDEyIDEwQzE2LjQxIDEwIDIwIDEzLjU5IDIwIDE4QzIwIDIyLjQxIDE2LjQxIDI2IDEyIDI2WiIgZmlsbD0iIzY2NzllYSIvPgo8L3N2Zz4K',\n                  new window.kakao.maps.Size(30, 30)\n                )\n              });\n              \n              userMarker.setMap(map);\n              setUserMarker(userMarker);\n              \n              console.log('🎉 카카오맵 초기화 완료 (사용자 위치 기반)');\n            } catch (error) {\n              console.error('❌ 카카오맵 초기화 오류:', error);\n              // 에러 발생 시 기본 위치로 초기화\n              initKakaoMapWithDefaultLocation();\n            }\n          },\n          (error) => {\n            console.log('❌ 위치 정보를 가져올 수 없습니다:', error);\n            // 위치 정보를 가져올 수 없으면 기본 위치로 초기화\n            initKakaoMapWithDefaultLocation();\n          },\n          {\n            enableHighAccuracy: true,\n            timeout: 10000,\n            maximumAge: 300000 // 5분\n          }\n        );\n      } else {\n        console.log('❌ 위치 정보를 지원하지 않습니다');\n        // 위치 정보를 지원하지 않으면 기본 위치로 초기화\n        initKakaoMapWithDefaultLocation();\n      }\n    } else {\n      console.error('❌ 카카오맵 API가 로드되지 않았습니다.');\n      console.log('🔄 1초 후 재시도...');\n      // 1초 후 다시 시도\n      setTimeout(initKakaoMap, 1000);\n    }\n  };\n\n  // 기본 위치로 지도 초기화하는 함수\n  const initKakaoMapWithDefaultLocation = () => {\n    console.log('📍 기본 위치로 지도 초기화 시작');\n    try {\n      const container = document.getElementById('map');\n      if (!container) {\n        console.error('❌ 지도 컨테이너를 찾을 수 없습니다.');\n        return;\n      }\n\n      const options = {\n        center: new window.kakao.maps.LatLng(37.5665, 126.9780), // 서울 시청\n        level: 6\n      };\n      \n      const map = new window.kakao.maps.Map(container, options);\n      setMapInstance(map);\n      setMapLoaded(true);\n      \n      console.log('✅ 카카오맵 초기화 완료 (기본 위치)');\n    } catch (error) {\n      console.error('❌ 카카오맵 기본 위치 초기화 오류:', error);\n      // 최종 폴백: 지도 컨테이너에 에러 메시지 표시\n      const container = document.getElementById('map');\n      if (container) {\n        container.innerHTML = `\n          <div style=\"display: flex; justify-content: center; align-items: center; height: 100%; background-color: #f5f5f5; color: #666;\">\n            <div style=\"text-align: center;\">\n              <h3>🗺️ 지도를 불러올 수 없습니다</h3>\n              <p>카카오맵 API 연결에 문제가 있습니다.</p>\n              <p>Vercel 환경에서 API 키 설정을 확인해주세요.</p>\n              <button onclick=\"window.location.reload()\" style=\"margin-top: 10px; padding: 8px 16px; background-color: #007bff; color: white; border: none; border-radius: 4px; cursor: pointer;\">\n                새로고침\n              </button>\n            </div>\n          </div>\n        `;\n      }\n    }\n  };\n\n  // 컴포넌트 마운트 시 지도 초기화\n  useEffect(() => {\n    // 지도 초기화\n    initKakaoMap();\n  }, []);\n\n  // 두 지점 간의 거리 계산 (하버사인 공식)\n  const calculateDistance = (lat1, lon1, lat2, lon2) => {\n    const R = 6371; // 지구의 반지름 (km)\n    const dLat = (lat2 - lat1) * Math.PI / 180;\n    const dLon = (lon2 - lon1) * Math.PI / 180;\n    const a = \n      Math.sin(dLat/2) * Math.sin(dLat/2) +\n      Math.cos(lat1 * Math.PI / 180) * Math.cos(lat2 * Math.PI / 180) * \n      Math.sin(dLon/2) * Math.sin(dLon/2);\n    const c = 2 * Math.atan2(Math.sqrt(a), Math.sqrt(1-a));\n    const distance = R * c; // km\n    return distance;\n  };\n\n  // 사용자 위치 가져오기\n  const getUserLocation = () => {\n    if (!navigator.geolocation) {\n      alert('이 브라우저에서는 위치 정보를 지원하지 않습니다.');\n      return;\n    }\n\n    setIsLoadingLocation(true);\n\n    navigator.geolocation.getCurrentPosition(\n      (position) => {\n        const { latitude, longitude } = position.coords;\n        const newUserLocation = { lat: latitude, lng: longitude };\n        setUserLocation(newUserLocation);\n        \n        // 지도가 로드된 후에만 중심 이동\n        if (mapInstance) {\n          // 기존 사용자 마커 제거\n          if (userMarker) {\n            userMarker.setMap(null);\n          }\n          \n          // 사용자 위치로 지도 중심 이동\n          mapInstance.setCenter(new window.kakao.maps.LatLng(latitude, longitude));\n          mapInstance.setLevel(5);\n          \n          // 새로운 사용자 위치 마커 추가\n          const newUserMarker = new window.kakao.maps.Marker({\n            position: new window.kakao.maps.LatLng(latitude, longitude),\n            image: new window.kakao.maps.MarkerImage(\n              'data:image/svg+xml;base64,PHN2ZyB3aWR0aD0iMjQiIGhlaWdodD0iMjQiIHZpZXdCb3g9IjAgMCAyNCAyNCIgZmlsbD0ibm9uZSIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIj4KPHBhdGggZD0iTTEyIDJDNi40OCAyIDIgNi40OCAyIDEyQzIgMTcuNTIgNi40OCAyMiAxMiAyMkMxNy41MiAyMiAyMiAxNy41MiAyMiAxMkMyMiA2LjQ4IDE3LjUyIDIgMTIgMlpNMTIgMjBDNy41OSAyMCA0IDE2LjQxIDQgMTJDNCA3LjU5IDcuNTkgNCAxMiA0QzE2LjQxIDQgMjAgNy41OSAyMCAxMkMyMCAxNi40MSAxNi40MSAyMCAxMiAyMFoiIGZpbGw9IiM2Njc5ZWEiLz4KPHBhdGggZD0iTTEyIDZDNi40OCA2IDIgMTAuNDggMiAxNkMyIDIxLjUyIDYuNDggMjYgMTIgMjZDNy41OSAyNiA0IDIyLjQxIDQgMThDNCAxMy41OSA3LjU5IDEwIDEyIDEwQzE2LjQxIDEwIDIwIDEzLjU5IDIwIDE4QzIwIDIyLjQxIDE2LjQxIDI2IDEyIDI2WiIgZmlsbD0iIzY2NzllYSIvPgo8L3N2Zz4K',\n              new window.kakao.maps.Size(30, 30)\n            )\n          });\n          \n          newUserMarker.setMap(mapInstance);\n          setUserMarker(newUserMarker);\n        }\n        \n        // 가까운 식당 찾기 (3km 이내)\n        const restaurantsWithDistance = restaurants.map(restaurant => {\n          const distance = calculateDistance(\n            latitude, \n            longitude, \n            restaurant.position.lat, \n            restaurant.position.lng\n          );\n          return {\n            ...restaurant,\n            distance: distance\n          };\n        });\n\n        const nearby = restaurantsWithDistance\n          .filter(restaurant => restaurant.distance <= 3)\n          .sort((a, b) => a.distance - b.distance);\n\n        setNearbyRestaurants(nearby);\n        setIsLoadingLocation(false);\n      },\n      (error) => {\n        let errorMessage = '위치 정보를 가져올 수 없습니다.';\n        switch(error.code) {\n          case error.PERMISSION_DENIED:\n            errorMessage = '위치 정보 접근이 거부되었습니다. 브라우저 설정에서 위치 정보 접근을 허용해주세요.';\n            break;\n          case error.POSITION_UNAVAILABLE:\n            errorMessage = '위치 정보를 사용할 수 없습니다.';\n            break;\n          case error.TIMEOUT:\n            errorMessage = '위치 정보 요청 시간이 초과되었습니다.';\n            break;\n        }\n        alert(errorMessage);\n        setIsLoadingLocation(false);\n      },\n      {\n        enableHighAccuracy: true,\n        timeout: 10000,\n        maximumAge: 300000 // 5분\n      }\n    );\n  };\n\n  const getCategoryColor = (category) => {\n    const colors = {\n      '한식': '#ff6b6b',\n      '양식': '#4ecdc4',\n      '일식': '#45b7d1',\n      '중식': '#96ceb4',\n      '동남아식': '#feca57',\n      '카페': '#ff9ff3'\n    };\n    return colors[category] || '#95a5a6';\n  };\n\n  // 현재 시간이 영업시간인지 확인하는 함수\n  const isCurrentlyOpen = (businessHours) => {\n    if (!businessHours) return false;\n    \n    const now = new Date();\n    const currentTime = now.getHours() * 100 + now.getMinutes();\n    \n    // 간단한 시간 파싱 (예: \"11:00 - 22:00\")\n    const timeMatch = businessHours.match(/(\\d{1,2}):(\\d{2})\\s*-\\s*(\\d{1,2}):(\\d{2})/);\n    if (!timeMatch) return true; // 파싱할 수 없으면 영업 중으로 간주\n    \n    const openHour = parseInt(timeMatch[1]);\n    const openMinute = parseInt(timeMatch[2]);\n    const closeHour = parseInt(timeMatch[3]);\n    const closeMinute = parseInt(timeMatch[4]);\n    \n    const openTime = openHour * 100 + openMinute;\n    const closeTime = closeHour * 100 + closeMinute;\n    \n    return currentTime >= openTime && currentTime <= closeTime;\n  };\n\n  // 평점을 별로 표시하는 함수\n  const renderStars = (rating) => {\n    const stars = [];\n    for (let i = 1; i <= 5; i++) {\n      stars.push(\n        <span key={i} className={`star ${i <= rating ? 'filled' : ''}`}>\n          ★\n        </span>\n      );\n    }\n    return stars;\n  };\n\n  return (\n    <div className=\"map-container\">\n      {/* 상단 검색 영역 */}\n      <div className=\"map-header\">\n        <h2>🗺️ 인슐랭 맛집 지도</h2>\n        \n        {/* 검색창 */}\n        <div className=\"search-section\">\n          <div className=\"search-container\">\n            <input\n              type=\"text\"\n              placeholder=\"지역명, 맛집 이름으로 검색...\"\n              value={searchQuery}\n              onChange={(e) => setSearchQuery(e.target.value)}\n              className=\"search-input\"\n            />\n            {searchQuery && (\n              <button onClick={clearSearch} className=\"clear-search-btn\">\n                ✕\n              </button>\n            )}\n          </div>\n          <div className=\"search-results\">\n            <span className=\"results-count\">\n              {filteredRestaurants.length}개의 맛집이 검색되었습니다\n            </span>\n          </div>\n        </div>\n      </div>\n\n      <div className=\"map-content\">\n        {/* 왼쪽 필터 패널 */}\n        <div className=\"filter-panel\">\n          <div className=\"filter-header\">\n            <h3>🍽️ 음식 종류 필터</h3>\n            <button \n              onClick={toggleAllCategories}\n              className=\"toggle-all-btn\"\n            >\n              {selectedCategories.length === categories.length ? '전체 해제' : '전체 선택'}\n            </button>\n          </div>\n          <div className=\"category-filters\">\n            {categories.map(category => (\n              <button\n                key={category}\n                onClick={() => toggleCategory(category)}\n                className={`category-filter-btn ${selectedCategories.includes(category) ? 'active' : ''}`}\n              >\n                {getCategoryIcon(category)} {category}\n              </button>\n            ))}\n          </div>\n          \n\n          \n          {/* 선택된 맛집 정보 */}\n          {selectedRestaurant && (\n            <div className=\"selected-restaurant-info\">\n              <h4>📋 선택된 맛집</h4>\n              <div className=\"restaurant-card\">\n                <h5>{selectedRestaurant.name}</h5>\n                <p className=\"restaurant-category\">{selectedRestaurant.category}</p>\n                <div className=\"restaurant-rating\">\n                  <span className=\"stars\">\n                    {renderStars(selectedRestaurant.rating)}\n                  </span>\n                  <span className=\"rating-text\">{selectedRestaurant.rating}</span>\n                </div>\n                <p className=\"restaurant-description\">{selectedRestaurant.description}</p>\n                <div className=\"restaurant-details\">\n                  <p>📍 {selectedRestaurant.address}</p>\n                  <p>💰 {selectedRestaurant.price}</p>\n                  <p>🕒 {selectedRestaurant.businessHours}</p>\n                  <p>📞 {selectedRestaurant.phone}</p>\n                  <p>🚗 {selectedRestaurant.parking}</p>\n                </div>\n                <div className=\"restaurant-actions\">\n                  <button \n                    className={`favorite-btn ${isInFavorites(selectedRestaurant.id) ? 'favorited' : ''}`}\n                    onClick={() => {\n                      if (isInFavorites(selectedRestaurant.id)) {\n                        removeFromFavorites(selectedRestaurant.id);\n                        alert('찜 목록에서 제거되었습니다! 👋');\n                      } else {\n                        addToFavorites(selectedRestaurant);\n                        alert('찜 목록에 추가되었습니다! 🎉');\n                      }\n                    }}\n                  >\n                    {isInFavorites(selectedRestaurant.id) ? '❤️ 찜됨' : '🤍 찜하기'}\n                  </button>\n                </div>\n              </div>\n            </div>\n          )}\n        </div>\n        \n        {/* 오른쪽 지도 */}\n        <div className=\"map-section\">\n          <div id=\"map\" style={{ width: '100%', height: '100%' }}></div>\n          \n          {/* 지도 위 위치 버튼 오버레이 */}\n          <div className=\"map-location-overlay\">\n            <button \n              className={`location-btn ${isLoadingLocation ? 'loading' : ''}`}\n              onClick={getUserLocation}\n              disabled={isLoadingLocation}\n            >\n              {isLoadingLocation ? '📍 위치 확인 중...' : '📍 내 위치로 이동'}\n            </button>\n          </div>\n          \n          {/* 미니 팝업 */}\n          {miniPopup && (\n            <div \n              className=\"mini-popup\"\n              style={{\n                left: `${popupPosition.x}px`,\n                top: `${popupPosition.y}px`\n              }}\n              onMouseDown={handleMouseDown}\n              onMouseMove={handleMouseMove}\n              onMouseUp={handleMouseUp}\n              onMouseLeave={handleMouseUp}\n            >\n              <div className=\"mini-popup-header\">\n                <h4>{miniPopup.name}</h4>\n                <button \n                  className=\"close-popup-btn\"\n                  onClick={() => setMiniPopup(null)}\n                >\n                  ✕\n                </button>\n              </div>\n              \n              <div className=\"mini-popup-content\">\n                <div className=\"mini-popup-rating\">\n                  <div className=\"stars\">\n                    {renderStars(miniPopup.rating)}\n                  </div>\n                  <span className=\"rating-text\">{miniPopup.rating}</span>\n                </div>\n                \n                <div className=\"mini-popup-info\">\n                  <p className=\"category\">🍽️ {miniPopup.category}</p>\n                  <p className={`business-status ${isCurrentlyOpen(miniPopup.businessHours) ? 'open' : 'closed'}`}>\n                    {isCurrentlyOpen(miniPopup.businessHours) ? '🟢 영업 중' : '🔴 영업 종료'}\n                  </p>\n                </div>\n                \n                <div className=\"mini-popup-actions\">\n                  <button \n                    className={`favorite-btn ${isInFavorites(miniPopup.id) ? 'favorited' : ''}`}\n                    onClick={() => {\n                      if (isInFavorites(miniPopup.id)) {\n                        removeFromFavorites(miniPopup.id);\n                        alert('찜 목록에서 제거되었습니다! 👋');\n                      } else {\n                        addToFavorites(miniPopup);\n                        alert('찜 목록에 추가되었습니다! 🎉');\n                      }\n                      setMiniPopup(null);\n                    }}\n                  >\n                    {isInFavorites(miniPopup.id) ? '❤️ 찜됨' : '🤍 찜하기'}\n                  </button>\n                  <button \n                    className=\"detail-btn\"\n                    onClick={() => {\n                      setDetailModal(miniPopup);\n                      setMiniPopup(null);\n                    }}\n                  >\n                    📋 상세보기\n                  </button>\n                </div>\n              </div>\n            </div>\n          )}\n        </div>\n      </div>\n      \n      {/* 상세정보 모달 */}\n      {detailModal && (\n        <RestaurantDetailModal\n          restaurant={detailModal}\n          onClose={() => setDetailModal(null)}\n        />\n      )}\n    </div>\n  );\n}\n\nexport default KakaoMap; "],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}